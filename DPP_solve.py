import numpy as np
import matplotlib.pyplot as plt
import scipy.stats
import random
import math
import csv
import pprint

X=[[1.5139235171749965, 2.3671040321985957], [2.8455477079235707, 0.6093582344416864], [2.1357172411851146, 0.7003372026200755], [0.11530635518683878, 2.8955613093597927], [0.2360680324918702, 0.47072544290537854], [1.361902039516922, 1.2737102183060829], [1.557142955977553, 0.5464503636251492], [0.10851869888707558, 1.7300772893377137], [0.24241053822927927, 0.05917149298866799], [3.07058826981213, 1.0659060513117604], [2.2737569764272987, 2.2802006967531296], [1.60664407703972, 2.7251295133339966], [2.6763352353249488, 2.108389599860413], [1.0897474042036641, 2.9062854477467295], [1.9582434366341033, 1.9461375286433922], [2.0549805530975838, 2.6477832295804253], [2.466608429694391, 2.6072578889153917], [1.3687892233689056, 0.5711301235010718], [0.15874081550130692, 1.6340660588240505], [0.6100819855431119, 1.9264965332750463]]

import sympy

n=28

sympy.var('k')

c=[0.024808194
, 0.022646909
,0.025964524
, 0.027352129
,0.023407511
, 0.021703221
,0.022421454
 ,0.027959705
 , 0.029097617
, 0.024349262
, 0.018766934
,0.019965258
, 0.026392303
, 0.027285194
, 0.027741146
, 0.026810136
, 0.026304106
, 0.026097485
, 0.009259399
,0.029625805
, 0.022978567
, 0.025939848
, 0.029244753
, 0.017005407
,0.025927714
, 0.023701971
, 0.026014561
, 0.028199717
, 0.025945538
, 0.025567858
, 0.026300223
, 0.023409254
, 0.029332270
, 0.025443066
, 0.027585821
, 0.030061046
, 0.027024503
, 0.030501787
, 0.017995398
,0.023862406]

v=n
for i in range(len(c)):
    v=v*(c[i]*k+1)



for i in range(len(c)):
    vv=c[i]*k
    for j in range(len(c)):
        if not j==i:
            vv=vv*(c[j]*k+1)
    v-=vv

poly = sympy.poly(v)

a=poly.all_coeffs()
print(a)
#print(v.coeff(k, 1))

def solve(vec,is_complex=False):
    dim =len(vec)
    if is_complex:
        A = np.zeros((dim,dim),dtype=complex)
    else:
        A = np.zeros((dim,dim))
    A[np.arange(dim-1),1+np.arange(dim-1)] =1
    A[-1,:] = -vec
    ans,vec = np.linalg.eig(A)
    return ans

a.reverse()
print(a)
print(len(a))
b=[]
for i in range(len(a)-1):
    b.append(a[i]/a[-1])
print(b)
print(len(b))
vec0 =np.array(b)
k=solve(vec0)
print(k)

truek=[]
for ki in k:
    if ki.imag==0.0:
        truek.append(ki)

print(truek)
lamlist=[]
for k in truek:
    lam=[]
    for i in range(len(c)):
        lam.append((c[i]*k/(c[i]*k+1)).real)
    lamlist.append(lam)

print(lamlist)
