import numpy as np
import matplotlib.pyplot as plt
import scipy.stats
import random
import math

X6=[[0.3792867335276325, 1.950488939292105], [0.12836889952507655, 0.20422533212852556], [0.489839037603313, 1.0273893483232186], [2.335239047338269, 2.511976341084248], [1.3055910883453483, 2.637418599488819], [2.9759270608282127, 0.07360707763577042], [1.330170795446663, 1.0778910731277673], [1.2100331530385762, 0.6106031429272996], [0.5709854814314912, 2.6092288209158254], [1.1097074958185458, 2.011440897921088], [1.9132724540760757, 1.203330056366217], [0.6482589481773727, 2.8543958151486577], [2.825262683728557, 0.8930673855843748], [2.075748714827975, 2.839466302721716], [2.6076559478388375, 2.1927193749081915], [1.464884193220323, 1.5249772140336393], [0.9052726934361649, 1.9970141000243289], [0.5617283790619311, 1.1748829956169933], [2.9802233404979397, 1.2824176965655991], [2.998508951911826, 2.1119687394629825], [2.8250395472042946, 2.982804664611138], [0.2806847789120289, 2.431655871357795], [1.7245952111918592, 2.3166104208351617], [0.16081087645167588, 0.14508724965147393], [0.5160095277486658, 1.3812410548991672], [1.4742473505336864, 2.051746673773112], [2.5543864162375267, 2.304326182639277], [1.323556787893661, 1.1926374540175682], [2.0793921344001975, 0.8567381201411894]]


#X6=[[1.5139235171749965, 2.3671040321985957], [2.8455477079235707, 0.6093582344416864], [2.1357172411851146, 0.7003372026200755], [0.11530635518683878, 2.8955613093597927], [0.2360680324918702, 0.47072544290537854], [1.361902039516922, 1.2737102183060829], [1.557142955977553, 0.5464503636251492], [0.10851869888707558, 1.7300772893377137], [0.24241053822927927, 0.05917149298866799], [3.07058826981213, 1.0659060513117604], [2.2737569764272987, 2.2802006967531296], [1.60664407703972, 2.7251295133339966], [2.6763352353249488, 2.108389599860413], [1.0897474042036641, 2.9062854477467295], [1.9582434366341033, 1.9461375286433922], [2.0549805530975838, 2.6477832295804253], [2.466608429694391, 2.6072578889153917], [1.3687892233689056, 0.5711301235010718], [0.15874081550130692, 1.6340660588240505], [0.6100819855431119, 1.9264965332750463]]


m=40

X=[0.6778141,0.6200708,0.7086080,0.7454694,0.6404197
,0.5947815
,0.6140332
,0.7615782
,0.7916968
,0.6655731
,0.5157943
, 0.5480846
, 0.7199825
, 0.7436936
, 0.7557857
, 0.7310834
, 0.7176381
, 0.7121444
, 0.2568846
, 0.8056544
, 0.6289476
, 0.7079516
, 0.7955864
, 0.4681896
, 0.7076288
, 0.6482895
, 0.7099390
, 0.7679365
, 0.7081029
, 0.6980523
, 0.7175349
, 0.6404663
, 0.7978994
, 0.6947298
, 0.7516676
, 0.8171450
, 0.7367751
, 0.8287710
, 0.4949641
, 0.6525753]

X=[0.18432171
 , 0.31725565
 , 0.79632922
 , 0.81164443
 , 0.47883381
 , 0.19536589
 , 0.40457973
 , 0.50463822
 , 0.58310061
, 0.48496572
, 0.64553830
, 0.21541638
, 0.47943749
, 0.41939318
, 0.52233836
, 0.56858192
, 0.72510623
, 0.67537542
, 0.75743111
, 0.66729364
, 0.47193002
, 0.73289932
, 0.43598724
, 0.57258313
, 0.42533295
, 0.51871007
, 0.22052689
, 0.60248602
, 0.33834092
, 0.38339733
, 0.61493419
, 0.29001503
, 0.73117374
, 0.74379436
, 0.47649928
, 0.69038702
, 0.08047325
, 0.59866841
, 0.33147147
, 0.30344232]

X=[0.703549280926145, 0.6841924658979398, 0.7129621146943455, 0.7234975136165578, 0.6912863269967725, 0.6749245527804548, 0.682026657989005, 0.727870936216067, 0.7357003117035441, 0.6996400644785643, 0.6422583177959456, 0.6563513769967169, 0.7162946372216208, 0.7230070940138095, 0.726313739482262, 0.719475811505032, 0.715613904569402, 0.7140062742470035, 0.469717625679217, 0.7391834220990627, 0.6873254083773018, 0.7127674915699247, 0.7366799064848859, 0.6193085195002567, 0.7126716921536737, 0.6939478150615066, 0.7133559551042606, 0.7295606944116737, 0.7128123928185853, 0.7098012448759851, 0.7155838592479963, 0.6913022173528065, 0.7372591363044724, 0.7087923825900925, 0.7251961972036973, 0.7419853453262494, 0.721080364993502, 0.7447619883267744, 0.6325562691469097, 0.6953786902399811]

"""
XX=[0.6946294
, 0.6341135
, 0.7270067
, 0.7658596
, 0.6554103
 6, 0.6076902
 7, 0.6278007
 8, 0.7828717
 9, 0.8147333
10, 0.6817793
11, 0.5254742
12, 0.5590272
13, 0.7389845
14, 0.7639854
15, 0.7767521
16, 0.7506838
17, 0.7365150
18, 0.7307296
19, 0.2592632
20, 0.8295225
21, 0.6433999
22, 0.7263158
23, 0.8188531
24, 0.4761514
25, 0.7259760
26, 0.6636552
27, 0.7284077
28, 0.7895921
29, 0.7264751
30, 0.7159000
31, 0.7364062
32, 0.6554591
33, 0.8213036
34, 0.7124059
35, 0.7724030
36, 0.8417093
37, 0.7566861
38, 0.8540500
39, 0.5038711
40, 0.6681474
"""



lis=[i for i in range(m)]

def K(x,y,lam):
    vec=0.0
    #print("sssssssssssss")
    for i in range(m):
        vec+= lam[i]/(1.0-lam[i]) * 4/(np.pi)**2  * math.sin((i+1)*x[0])*math.sin((i+1)*x[1])  * math.sin((i+1)*y[0])*math.sin((i+1)*y[1])
    #print("vec=",vec)
    return vec

def Phi(lam,phi):
    A=np.ones((len(phi),len(phi)))
    for x1 in range(len(phi)):
        for x2 in range(len(phi)):
            #print(phix1)
            #print(lam)
            #print("dede")
            #print(K(phix1,phix2,lam))
            A[x1][x2]=K(phi[x1],phi[x2],lam)
    print(A)
    #print(math.log(np.linalg.det(A).real))
    return np.linalg.det(A)

def log1(lam):
    vv=0
    for i in lis:
        vv+=math.log(1-lam[i])
    return vv
"""
X=[]
for i in range(m):
    X.append(0.7)
"""

Xreal=[]
for i in range(20):
    Xreal.append(0.7)
for i in range(20):
    Xreal.append(0.3)

print(Xreal)
print(len(Xreal))

print("--------------")
KKK=Phi(Xreal,X6)
print("logdet(K')=",math.log(KKK))
fff=log1(Xreal)+math.log(KKK)
print("log1(Xreal)=",log1(Xreal))
print("lamda=",Xreal)
print("logf(phi)=",fff)
efff=math.e**fff
print("f(phi)=",efff)
print("--------------")


print("--------------")
KKK=Phi(X,X6)
print("logdet(K')=",math.log(KKK))
fff=log1(X)+math.log(KKK)
print("log1(X)=",log1(X))
print("lamda=",X)
print("logf(phi)=",fff)
efff=math.e**fff
print("f(phi)=",efff)
print("--------------")
